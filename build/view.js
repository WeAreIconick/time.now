(()=>{function t(t){let n=t.dataset.calendarId,a=[];t.dataset.defaultView;const s=t.dataset.accentColor||"#3b82f6";if(t.dataset.events)try{a=JSON.parse(t.dataset.events)}catch(t){}if((!a||0===a.length)&&n&&(n.startsWith("[")||n.startsWith("{")))try{a=JSON.parse(n),n=""}catch(t){}if(!a||0===a.length){const e=t.attributes;for(let t=0;t<e.length;t++){const n=e[t],r=n.name,o=n.value;if(r.startsWith("data-")&&o&&(o.startsWith("[")||o.startsWith("{")))try{const t=JSON.parse(o);if(Array.isArray(t)&&t.length>0){a=t;break}}catch(t){}}}let i=new Date,c=null;if(a&&a.length>0){const e=new Date(a[0].start),n=new Date(a[a.length-1].start);t.dataset.currentWeekDate=i.toISOString(),c={start:e,end:n},t.dataset.eventDateRange=JSON.stringify({start:e.toISOString(),end:n.toISOString()})}const d=e(a,0,i);t.innerHTML=d,r(t,a),o(t,a,s,c)}function e(t,e,r=new Date){const a=n(r),o=a[0].toLocaleDateString("en-US",{month:"long",year:"numeric"}),s=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];let i="";a.forEach((t,e)=>{const n=s[e],r=t.getDate(),a=t.toDateString()===(new Date).toDateString();i+=`\n\t\t\t<div class="text-center py-3 border-r-2 border-black last:border-r-0">\n\t\t\t\t<div class="text-xs uppercase tracking-widest">${n}</div>\n\t\t\t\t<div class="text-2xl mt-1 ${a?"bg-black text-white w-10 h-10 flex items-center justify-center mx-auto border-2 border-black":""}">${r}</div>\n\t\t\t</div>\n\t\t`});let c="";for(let t=10;t<=20;t++)c+=`<div class="h-16 border-b border-black pr-2 text-right pt-1 text-xs uppercase tracking-wide">${12===t?"12 PM":t<12?`${t} AM`:t-12+" PM"}</div>`;let d="";return a.forEach((t,e)=>{const n=t.toDateString()===(new Date).toDateString();d+=`\n\t\t\t<div class="day-column border-r-2 border-black last:border-r-0 relative ${n?"bg-yellow-50":""}">\n\t\t\t\t${Array(11).fill().map(t=>'<div class="h-16 border-b border-black hover:bg-gray-50 transition-colors cursor-pointer"></div>').join("")}\n\t\t\t\t<div class="absolute top-0 left-0 right-0 p-2 pointer-events-none">\n\t\t\t\t\t<div class="events-container space-y-1 pointer-events-auto"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`}),`\n\t\t\x3c!-- Height calculation: \n\t\t     Desktop: Content(900px) + Border(8px) = 908px total\n\t\t     Mobile: Content(500px) + Border(8px) = 508px total\n\t\t--\x3e\n\t\t<div class="h-[508px] md:h-[908px] flex flex-col bg-white border-4 border-black">\n\t\t\t\x3c!-- Header --\x3e\n\t\t\t<div class="flex flex-col md:flex-row items-center justify-between p-2 md:p-4 border-b-4 border-black bg-white gap-2 md:gap-4">\n\t\t\t\t<div class="flex items-center gap-2 md:gap-4 flex-wrap justify-center md:justify-start">\n\t\t\t\t\t<div class="flex items-center gap-2 px-3 py-1 bg-black text-white border-2 border-black">\n\t\t\t\t\t\t<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5">\n\t\t\t\t\t\t\t<path d="M8 2v4"></path>\n\t\t\t\t\t\t\t<path d="M16 2v4"></path>\n\t\t\t\t\t\t\t<rect width="18" height="18" x="3" y="4" rx="2"></rect>\n\t\t\t\t\t\t\t<path d="M3 10h18"></path>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t<span class="uppercase tracking-wider text-sm md:text-base">Calendar</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<button class="today-button border-2 border-black hover:bg-black hover:text-white transition-colors px-3 py-1 text-xs md:text-sm font-medium">Today</button>\n\t\t\t\t\t<div class="flex items-center">\n\t\t\t\t\t\t<button class="nav-button border-2 border-black border-r-0 rounded-none hover:bg-black hover:text-white transition-colors w-8 h-8 md:w-9 md:h-9 flex items-center justify-center" data-action="prev">\n\t\t\t\t\t\t\t<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4 md:w-5 md:h-5">\n\t\t\t\t\t\t\t\t<path d="m15 18-6-6 6-6"></path>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t\t<button class="nav-button border-2 border-black rounded-none hover:bg-black hover:text-white transition-colors w-8 h-8 md:w-9 md:h-9 flex items-center justify-center" data-action="next">\n\t\t\t\t\t\t\t<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4 md:w-5 md:h-5">\n\t\t\t\t\t\t\t\t<path d="m9 18 6-6-6-6"></path>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<h2 class="uppercase tracking-wide text-sm md:text-base text-center md:text-left">${o}</h2>\n\t\t\t</div>\n\t\t\t\n\t\t\t\x3c!-- Desktop Week View --\x3e\n\t\t\t<div class="hidden md:flex flex-col bg-white">\n\t\t\t\t<div class="sticky top-0 bg-white border-b-2 border-black z-10 grid grid-cols-[60px_repeat(7,1fr)]">\n\t\t\t\t\t<div class="border-r-2 border-black"></div>\n\t\t\t\t\t${i}\n\t\t\t\t</div>\n\t\t\t\t<div>\n\t\t\t\t\t<div class="grid grid-cols-[60px_repeat(7,1fr)]">\n\t\t\t\t\t\t<div class="border-r-2 border-black bg-gray-50">\n\t\t\t\t\t\t\t${c}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t${d}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t\n\t\t\t\x3c!-- Mobile Day View --\x3e\n\t\t\t<div class="md:hidden flex flex-col bg-white">\n\t\t\t\t<div class="sticky top-0 bg-white border-b-2 border-black z-10 p-3">\n\t\t\t\t\t<div class="text-center">\n\t\t\t\t\t\t<h3 class="text-base font-medium uppercase tracking-wide">${r.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"})}</h3>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="overflow-y-auto">\n\t\t\t\t\t<div class="p-3">\n\t\t\t\t\t\t<div class="space-y-3">\n\t\t\t\t\t\t\t${t.filter(t=>new Date(t.start).toDateString()===r.toDateString()).map(t=>{const e=new Date(t.start),n=new Date(t.end),r=e.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}),a=n.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0});return`\n\t\t\t\t\t\t\t\t\t<div class="border-2 border-black bg-white p-3 shadow cursor-pointer hover:bg-gray-50 transition-colors" onclick="showEventPopup(${JSON.stringify(t).replace(/"/g,"&quot;")})">\n\t\t\t\t\t\t\t\t\t\t<div class="flex items-center justify-between mb-2">\n\t\t\t\t\t\t\t\t\t\t\t<h4 class="font-medium text-sm">${t.title}</h4>\n\t\t\t\t\t\t\t\t\t\t\t<span class="text-xs text-gray-600">${r} - ${a}</span>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t${t.description?`<p class="text-xs text-gray-600 line-clamp-2">${t.description}</p>`:""}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t`}).join("")||'<div class="text-center text-gray-500 py-8">No events today</div>'}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`}function n(t){const e=[],n=new Date(t),r=n.getDay(),a=n.getDate()-r;n.setDate(a);for(let t=0;t<7;t++){const r=new Date(n);r.setDate(n.getDate()+t),e.push(r)}return e}function r(t,e){const r=t.querySelectorAll(".day-column");let o=new Date;t.dataset.currentWeekDate&&(o=new Date(t.dataset.currentWeekDate));const i=n(o);r.forEach(t=>{const e=t.querySelector(".events-container");e&&(e.innerHTML="")}),e.forEach((t,e)=>{if(!t.start)return;const n=new Date(t.start),o=i.findIndex(t=>t.toDateString()===n.toDateString());if(-1===o)return;const c=r[o];if(!c)return;if(!c.querySelector(".events-container"))return;const d=function(t){const e=document.createElement("div");let n="No Title";t.title&&"No Title"!==t.title?n=t.title:t.summary&&"No Title"!==t.summary?n=t.summary:t.name?n=t.name:t.subject&&(n=t.subject);const r=a(new Date(t.start),t.end?new Date(t.end):null),o=t.backgroundColor||"#3b82f6",i="#3b82f6"===o?"bg-blue-200":"#10b981"===o?"bg-green-200":"#f59e0b"===o?"bg-yellow-200":"#ef4444"===o?"bg-red-200":"#8b5cf6"===o?"bg-purple-200":"#ec4899"===o?"bg-pink-200":"bg-blue-200";return e.className=`calendar-event ${i} text-black p-2 mb-1 cursor-pointer transition-all hover:translate-x-1 hover:-translate-y-0.5 border-2 border-black shadow`,e.innerHTML=`\n\t\t<div class="text-xs uppercase tracking-wide">${r}</div>\n\t\t<div class="mt-0.5">${n}</div>\n\t`,e.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),s(t)}),e}(t),l=n.getHours(),u=n.getMinutes();if(l<10||l>20)return;const p=r[o];if(p){const t=p.querySelector(".events-container");if(t){const e=64*(l-10)+u/60*64;d.style.top=`${e}px`,d.style.position="absolute",t.appendChild(d.cloneNode(!0))}}})}function a(t,e=null){const n=t=>{const e=t.getHours(),n=e>=12?"PM":"AM";return`${e%12||12}:${t.getMinutes().toString().padStart(2,"0")} ${n}`},r=n(t),a=e?n(e):null;return a?`${r} - ${a}`:r}function o(t,n,a,s=null){(()=>{const e=new Date(t.dataset.currentWeekDate||new Date),n=t.querySelector('.nav-button[data-action="prev"]'),r=t.querySelector('.nav-button[data-action="next"]');if(s){const t=new Date(e);t.setDate(e.getDate()-7);const a=t>=s.start,o=new Date(e);o.setDate(e.getDate()+7);const i=o<=s.end;n&&(n.disabled=!a,n.style.opacity=a?"1":"0.5",n.style.cursor=a?"pointer":"not-allowed"),r&&(r.disabled=!i,r.style.opacity=i?"1":"0.5",r.style.cursor=i?"pointer":"not-allowed")}})();const i=t.querySelector(".today-button");i&&i.addEventListener("click",()=>{const s=new Date;t.dataset.currentWeekDate=s.toISOString(),t.innerHTML=e(n,0,s),r(t,n),o(t,n,a)});const c=t.querySelector('.nav-button[data-action="prev"]');c&&c.addEventListener("click",()=>{const i=new Date(t.dataset.currentWeekDate||new Date),c=new Date(i);window.innerWidth<768?c.setDate(i.getDate()-1):c.setDate(i.getDate()-7),s&&c<s.start||(t.dataset.currentWeekDate=c.toISOString(),t.innerHTML=e(n,0,c),r(t,n),o(t,n,a))});const d=t.querySelector('.nav-button[data-action="next"]');d&&d.addEventListener("click",()=>{const i=new Date(t.dataset.currentWeekDate||new Date),c=new Date(i);window.innerWidth<768?c.setDate(i.getDate()+1):c.setDate(i.getDate()+7),s&&c>s.end||(t.dataset.currentWeekDate=c.toISOString(),t.innerHTML=e(n,0,c),r(t,n),o(t,n,a))})}function s(t){const e=document.querySelector(".calendar-event-popup");e&&e.remove();const n=document.createElement("div");n.className="calendar-event-popup-overlay",n.addEventListener("click",function(t){t.target===n&&i()});const r=document.createElement("div");r.className="calendar-event-popup";const o=new Date(t.start),s=t.end?new Date(t.end):null,d=o.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),l=a(o,s);let u=`\n\t\t<div class="popup-header">\n\t\t\t<h3 class="popup-title">${t.title}</h3>\n\t\t\t<button class="popup-close">&times;</button>\n\t\t</div>\n\t\t<div class="popup-body">\n\t\t\t<div class="popup-date">${d}</div>\n\t\t\t<div class="popup-time">${l}</div>\n\t`;t.location&&(u+=`<div class="popup-location">📍 ${t.location}</div>`),t.description?u+=`<div class="popup-description">${t.description}</div>`:u+='<div class="popup-description popup-no-description">No description available</div>',u+="</div>",r.innerHTML=u,r.querySelector(".popup-close").addEventListener("click",i),n.appendChild(r),document.body.appendChild(n),document.addEventListener("keydown",c)}function i(){const t=document.querySelector(".calendar-event-popup-overlay");t&&t.remove(),document.removeEventListener("keydown",c)}function c(t){"Escape"===t.key&&i()}function d(){const e=[".calendar-block-wrapper[data-calendar-id]","[data-block-id]",".wp-block-time-now-google-calendar",'[class*="calendar"]'];let n=[];for(const t of e){const e=document.querySelectorAll(t);if(e.length>0){n=Array.from(e);break}}n=n.filter(t=>t.dataset.calendarId||t.dataset.events),n=[...new Set(n)],n.forEach(e=>{t(e)})}window.closeEventPopup=i,window.showEventPopup=s,"loading"===document.readyState?document.addEventListener("DOMContentLoaded",d):d(),setTimeout(d,1e3),document.addEventListener("DOMContentLoaded",function(){new MutationObserver(function(e){e.forEach(function(e){e.addedNodes.forEach(function(e){if(1===e.nodeType){e.classList&&e.classList.contains("calendar-block-wrapper")&&t(e);const n=e.querySelectorAll?.(".calendar-block-wrapper[data-calendar-id]");n&&n.forEach(t)}})})}).observe(document.body,{childList:!0,subtree:!0})})})();