(()=>{function t(t){console.log("Container data attributes:",{calendarId:t.dataset.calendarId,events:t.dataset.events,defaultView:t.dataset.defaultView,accentColor:t.dataset.accentColor,allAttributes:t.attributes});let n=t.dataset.calendarId;if(n&&!n.startsWith("[")&&!n.startsWith("{")){const t=`https://calendar.google.com/calendar/u/0/r/week?cid=${encodeURIComponent(n)}`;console.log("üîó Google Calendar Link:",t),console.log("üìÖ Direct link to view your calendar in Google Calendar (copy this URL):"),console.log(t)}let a=[];const l=t.dataset.defaultView||"timeGridWeek",r=t.dataset.accentColor||"#3b82f6";if(t.dataset.events)try{a=JSON.parse(t.dataset.events),console.log("Parsed events from data-events:",a),a.length>0&&(console.log("First event structure:",a[0]),console.log("First event title property:",a[0].title),console.log("First event summary property:",a[0].summary))}catch(t){console.error("Error parsing events from data-events:",t)}if((!a||0===a.length)&&(console.log("No events in data-events, checking calendarId for JSON data"),n&&(n.startsWith("[")||n.startsWith("{"))))try{a=JSON.parse(n),console.log("Found events in calendarId:",a),a.length>0&&(console.log("First event from calendarId:",a[0]),console.log("First event title:",a[0].title),console.log("First event summary:",a[0].summary)),n=""}catch(t){console.error("Error parsing events from calendarId:",t)}if(!a||0===a.length){console.log("Checking all data attributes for JSON data");for(let e=0;e<t.attributes.length;e++){const n=t.attributes[e];if(n.name.startsWith("data-")){const t=n.value;if(t&&(t.startsWith("[")||t.startsWith("{")))try{const e=JSON.parse(t);if(Array.isArray(e)&&e.length>0&&e[0].title){a=e,console.log(`Found events in ${n.name}:`,a);break}}catch(t){}}}}console.log("Final calendar data:",{calendarId:n,events:a,eventsCount:a.length,defaultView:l,accentColor:r}),a.length>0?(console.log("üîç Event Analysis:"),console.log("Total events found:",a.length),a.forEach((t,e)=>{console.log(`üìÖ Event ${e+1}:`,{id:t.id,title:t.title,summary:t.summary||"NOT SET",description:t.description||"NOT SET",start:t.start,end:t.end,allProperties:Object.keys(t)}),console.log(`üìã Raw event ${e+1} data:`,t)})):console.log("‚ö†Ô∏è No events found in the data"),t.innerHTML="",t.innerHTML=e(),s(t),o(t,a)}function e(t,e,o=null){const a=o||new Date,s=n(a),l=s[3].toLocaleDateString("en-US",{month:"long",year:"numeric"}),r=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];let i="",c="";i+='<div class="time-column"></div>',s.forEach((t,e)=>{const n=t.toDateString()===a.toDateString();i+=`\n\t\t\t<div class="day-header">\n\t\t\t\t<div class="day-name">${r[e]}</div>\n\t\t\t\t<div class="day-number${n?" today":""}">${t.getDate()}</div>\n\t\t\t</div>\n\t\t`}),c+='<div class="time-column">';for(let t=10;t<=20;t++)c+=`<div class="time-slot">${12===t?"12 PM":t<12?`${t} AM`:t-12+" PM"}</div>`;return c+="</div>",s.forEach((t,e)=>{const n=t.toDateString()===a.toDateString();c+=`\n\t\t\t<div class="day-column${n?" today-column":""}">\n\t\t\t\t${Array(11).fill().map(()=>'<div class="time-slot"></div>').join("")}\n\t\t\t\t<div class="events-container">\n\t\t\t\t\t<div class="events-list"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`}),`\n\t\t<div class="calendar-header">\n\t\t\t<div class="header-left">\n\t\t\t\t<div class="calendar-title">\n\t\t\t\t\t<svg class="calendar-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">\n\t\t\t\t\t\t<path d="M8 2v4"></path><path d="M16 2v4"></path><rect width="18" height="18" x="3" y="4" rx="2"></rect><path d="M3 10h18"></path>\n\t\t\t\t\t</svg>\n\t\t\t\t\t<span class="calendar-text">Calendar</span>\n\t\t\t\t</div>\n\t\t\t\t<button class="today-button" data-action="today">Today</button>\n\t\t\t\t<div class="navigation">\n\t\t\t\t\t<button class="nav-button" data-action="prev">\n\t\t\t\t\t\t<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5" aria-hidden="true"><path d="m15 18-6-6 6-6"></path></svg>\n\t\t\t\t\t</button>\n\t\t\t\t\t<button class="nav-button" data-action="next">\n\t\t\t\t\t\t<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5" aria-hidden="true"><path d="m9 18 6-6-6-6"></path></svg>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t\t<h2 class="month-title">${l}</h2>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="calendar-body">\n\t\t\t<div class="calendar-content">\n\t\t\t\t<div class="week-header">\n\t\t\t\t\t${i}\n\t\t\t\t</div>\n\t\t\t\t<div class="calendar-grid">\n\t\t\t\t\t<div class="time-grid">\n\t\t\t\t\t\t${c}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`}function n(t){const e=[],n=t.getDay(),o=new Date(t);o.setDate(t.getDate()-n);for(let t=0;t<7;t++){const n=new Date(o);n.setDate(o.getDate()+t),e.push(n)}return e}function o(t,e){const o=t.querySelectorAll(".day-column");let s=new Date;t.dataset.currentWeekDate&&(s=new Date(t.dataset.currentWeekDate));const l=n(s);console.log("Positioning events:",{eventsCount:e.length,dayColumnsCount:o.length,weekDates:l.map(t=>t.toDateString())}),o.forEach(t=>{const e=t.querySelector(".events-list");e&&(e.innerHTML="")}),e.forEach((t,e)=>{if(console.log(`Processing event ${e}:`,t),!t.start)return void console.log("Event has no start time, skipping:",t);const n=new Date(t.start),s=l.findIndex(t=>t.toDateString()===n.toDateString());if(console.log(`Event date: ${n.toDateString()}, Day index: ${s}`),-1===s)return void console.log("Event not in current week, skipping");const i=o[s];if(!i)return void console.log("Day column not found for index:",s);const c=i.querySelector(".events-list");if(!c)return void console.log("Events list not found in day column");const d=function(t){console.log("Creating event element for:",t),console.log("Event properties:",Object.keys(t));const e=document.createElement("div");e.className="calendar-event";const n=["blue-event","purple-event","pink-event","green-event","yellow-event"],o=t.backgroundColor?{"#3b82f6":"blue-event","#a855f7":"purple-event","#ec4899":"pink-event","#22c55e":"green-event","#f59e0b":"yellow-event"}[t.backgroundColor]||"blue-event":n[Math.floor(Math.random()*n.length)];e.classList.add(o);let s="No Title";console.log("üîç Checking title properties for event:",{title:t.title,summary:t.summary,name:t.name,subject:t.subject,allProperties:Object.keys(t)}),t.title&&"No Title"!==t.title?(s=t.title,console.log("‚úÖ Using event.title:",s)):t.summary&&"No Title"!==t.summary?(s=t.summary,console.log("‚úÖ Using event.summary:",s)):t.name?(s=t.name,console.log("‚úÖ Using event.name:",s)):t.subject?(s=t.subject,console.log("‚úÖ Using event.subject:",s)):console.log("‚ùå No valid title property found, using default"),console.log("üéØ Final event title resolved to:",s);const l=a(new Date(t.start),t.end?new Date(t.end):null);return e.innerHTML=`\n\t\t<div class="event-time">${l}</div>\n\t\t<div class="event-title">${s}</div>\n\t`,e.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),r(t)}),e}(t),u=n.getHours(),v=n.getMinutes();if(u<10||u>20)return void console.log(`Event ${t.title} is outside 10am-8pm range (${u}:${v}), skipping`);const p=u-10,g=64*p+v/60*64+8;d.style.top=`${g}px`,d.style.position="absolute",console.log(`Adding event to calendar: ${t.title} at position ${g}px (hour ${u}, adjusted ${p})`),c.appendChild(d)})}function a(t,e){const n=t=>{const e=t.getHours(),n=e>=12?"PM":"AM";return`${e%12||12}:${t.getMinutes().toString().padStart(2,"0")} ${n}`},o=n(t),a=e?n(e):null;return a?`${o} - ${a}`:o}function s(t){let n=new Date;t.dataset.currentWeekDate&&(n=new Date(t.dataset.currentWeekDate));const a=t.querySelector(".today-button");a&&a.addEventListener("click",()=>{const n=JSON.parse(t.dataset.events||"[]"),a=new Date;t.dataset.currentWeekDate=a.toISOString(),t.innerHTML=e(0,t.dataset.accentColor,a),s(t),o(t,n)});const l=t.querySelector('.nav-button[data-action="prev"]'),r=t.querySelector('.nav-button[data-action="next"]');l&&l.addEventListener("click",()=>{const a=JSON.parse(t.dataset.events||"[]"),l=new Date(n);l.setDate(l.getDate()-7),t.dataset.currentWeekDate=l.toISOString(),t.innerHTML=e(0,t.dataset.accentColor,l),s(t),o(t,a)}),r&&r.addEventListener("click",()=>{const a=JSON.parse(t.dataset.events||"[]"),l=new Date(n);l.setDate(l.getDate()+7),t.dataset.currentWeekDate=l.toISOString(),t.innerHTML=e(0,t.dataset.accentColor,l),s(t),o(t,a)})}function l(){let e=[];[".calendar-block-wrapper[data-calendar-id]","[data-block-id]",".wp-block-calendar-block-google-calendar",'[class*="calendar"]'].forEach(t=>{document.querySelectorAll(t).forEach(t=>{(t.dataset.calendarId||t.dataset.events)&&e.push(t)})}),e=[...new Set(e)],console.log("Found calendar containers:",e.length,e),e.forEach(t)}function r(t){const e=document.querySelector(".calendar-event-popup");e&&e.remove();const n=document.createElement("div");n.className="calendar-event-popup-overlay",n.addEventListener("click",function(t){t.target===n&&i()});const o=document.createElement("div");o.className="calendar-event-popup";const s=new Date(t.start),l=t.end?new Date(t.end):null,r=s.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),d=a(s,l);let u=`\n\t\t<div class="popup-header">\n\t\t\t<h3 class="popup-title">${t.title}</h3>\n\t\t\t<button class="popup-close">&times;</button>\n\t\t</div>\n\t\t<div class="popup-body">\n\t\t\t<div class="popup-date">${r}</div>\n\t\t\t<div class="popup-time">${d}</div>\n\t`;t.location&&(u+=`<div class="popup-location">üìç ${t.location}</div>`),t.description?u+=`<div class="popup-description">${t.description}</div>`:u+='<div class="popup-description popup-no-description">No description available</div>',u+="</div>",o.innerHTML=u,o.querySelector(".popup-close").addEventListener("click",i),n.appendChild(o),document.body.appendChild(n),document.addEventListener("keydown",c)}function i(){const t=document.querySelector(".calendar-event-popup-overlay");t&&t.remove(),document.removeEventListener("keydown",c)}function c(t){"Escape"===t.key&&i()}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",l):l(),setTimeout(l,1e3),document.addEventListener("DOMContentLoaded",function(){new MutationObserver(function(e){e.forEach(function(e){e.addedNodes.forEach(function(e){if(1===e.nodeType){e.classList&&e.classList.contains("calendar-block-wrapper")&&t(e);const n=e.querySelectorAll?.(".calendar-block-wrapper[data-calendar-id]");n&&n.forEach(t)}})})}).observe(document.body,{childList:!0,subtree:!0})}),window.closeEventPopup=i,window.showEventPopup=r})();